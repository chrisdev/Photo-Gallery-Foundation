<!doctype html>
<head>
  <!-- 
    This sample shows how to use jQuery to expand one div to take over 
    the screen and then expand the previous div to come back.
    
    http://hectorcorrea.com/Blog/Sliding-in-a-Full-Page-Panel-with-CSS-and-jQuery
    
    The basics of this code came from the excellent "Sliding Panel Photo Wall Gallery with jQuery"
    by Mary Lou at http://tympanus.net/codrops/2010/05/14/sliding-panel-photo-wall-gallery-with-jquery/
    
    Text for Lorem ipsum taken from http://www.lipsum.com/
    Text for Bacon ipsum taken http://baconipsum.com/
  -->
  <title>Photo Gallery with a Sliding Full Panel with CSS and jQuery</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="description" content="Photo Gallery with a Sliding Full Panel with CSS and jQuery" />
  <meta name="keywords" content="css, jquery, slide, photo, gallery, panel"/>
  
  <style type="text/css">
    .body { 
      font-size: 16px;
    }
    
    #mainDiv {
      background-color:#FFFAF0;
      position:fixed;
      left:0px;                    
      right:0px;
      bottom:0px;
      height:100%;
      width:100%;
      overflow-y:scroll; /* let this panel scroll */
    }
    
    #mainDiv img{
        opacity:0.9;
    }
            
    #galleryDiv{
      background-color:#222;
      position:fixed;
      left:0px;
      right:0px;
      bottom:0px;
      overflow-y:scroll; /* let this panel scroll */
      display: none;
      text-align:center;
          margin:40px auto 0px auto;
    }
    
    #galleryDiv img{
        cursor:pointer;
        position:relative;
        border:1px solid #000;
        -moz-box-shadow:0px 0px 10px #111;
        -webkit-box-shadow:0px 0px 10px #111;
        box-shadow:0px 0px 10px #111;
        display:none;
    }
    
    #galleryContent{
        position:relative;
        margin:40px auto 0px auto;
    }
    
    a#next,
    a#prev{
        width:40px;
        height:40px;
        position:fixed;
        cursor:pointer;
        outline:none;
        display:none;
        background:#aaa url(nav.png) no-repeat top left;
    }
    a#next:hover, a#prev:hover{
        background-color:#fff;
    }
    a#next{
        right:0px;
        top:50%;
        margin-top:-20px;
        background-position: 0px 0px;
    }
    a#prev{
        left:0px;
        top:50%;
        margin-top:-20px;
        background-position: 0px -40px;
    }
    
    #galleryContent #closeButton {
    		position: fixed;
    		top: 10px;
    		right: 10px;
    		display: none;
    		cursor: pointer;
    		
    		background-color:#000;
        font-family:Verdana;
        text-transform:uppercase;
        color:#fff;
        font-size:10px;
    }
  </style>
</head>

<body>
  
  <div id="mainDiv">
    <div id="mainContent">
      <div id="header">header</div>
      <div id="nav">option 1 | option 2 | option 3</div>
      <div id="content">
        <p><b><i>Click on a picture to view in full size</i></b></p>
        
        <img src='http://hectorykarla.com/pictures/2011/nyc04_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc04_sm.jpg ' 
          title='Good morning Big Apple' />
        <img src='http://hectorykarla.com/pictures/2011/nyc08_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc08_sm.jpg' 
          title='Good morning Big Apple' />
        <img src='http://hectorykarla.com/pictures/2011/nyc16_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc16_sm.jpg' 
          title='Central Park' />
        
        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <p>1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non 
        purus quis tellus condimentum posuere eget id magna. Nunc hendrerit, 
        metus in faucibus scelerisque, ante mi auctor lacus, ut ullamcorper 
        lectus magna sed nunc. Donec gravida placerat justo, facilisis eleifend 
        lorem dictum nec. Nunc rutrum varius risus vitae mollis. Vivamus nunc 
        diam, viverra at molestie fermentum, accumsan nec metus. Aenean gravida 
        quam vel nisl rhoncus facilisis. Duis hendrerit mi ut purus iaculis 
        euismod. Ut convallis odio non leo faucibus gravida.</p>

        <img src='http://hectorykarla.com/pictures/2011/nyc13_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc13_sm.jpg' 
          title='Cathedral' />
        <img src='http://hectorykarla.com/pictures/2011/nyc11_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc11_sm.jpg' 
          title='Columbia University' />
        <img src='http://hectorykarla.com/pictures/2011/nyc05_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc05_sm.jpg' 
          title='Jamaican Chicken Jerk at Amy Ruths' />
        <img src='http://hectorykarla.com/pictures/2011/nyc02_sm_thumb.jpg' 
          alt='http://hectorykarla.com/pictures/2011/nyc02_sm.jpg' 
          title='The Apple Store in 5th Avenue' />
        
        <p>1 Etiam ut consequat nisi. Ut tristique elit quis eros condimentum 
          dignissim. Proin feugiat aliquet adipiscing. Morbi vitae vestibulum neque. 
          Sed sagittis, odio et pretium faucibus, ante leo molestie nulla, eget 
          accumsan magna nunc vel nulla. Integer luctus venenatis purus quis tincidunt. 
          Duis et massa nisl, sit amet pellentesque ante. Sed at ipsum ut magna 
          interdum ultricies. Phasellus vitae arcu orci, eget iaculis mi. Etiam a 
          ultrices tellus. Maecenas suscipit est sed erat lobortis a tincidunt enim 
          convallis. Sed justo massa, lobortis vitae aliquam at, consequat a lacus. 
          Donec sit amet pellentesque nisl.</p>
      </div> <!-- content -->
      <div id="footer">footer</div>
    </div> <!-- main -->
  </div> <!-- mainDiv -->

  <div id="galleryDiv">
    <div id="galleryContent">
       <a id="prev"></a>
       <a id="next"></a>
       <a id="closeButton">Close</a>
    </div>
  </div>

  <!-- TODO: use HTML boilerplate technique (CDN -> local) -->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
  
  <!-- Picture gallery JavaScript -->
  <script type="text/javascript">
  $(function() {
  
    var currentPicture = -1;
    var totalpictures = $('#mainDiv img').size();
    var showGallerySpeed = 500; // ms
    var nextPictureSpeed = 700; // ms
    
    // Resize picture when user resizes the window
    $(window).bind('resize', function() {
        var $picture = $('#galleryContent').find('img');
        resize($picture);
    });
    
    // Start with the mainDiv in full view...
    $('#mainDiv').css({'height':'100%'}); 
    $('#mainDiv').show();
    
    // ...and the galleryDiv collapsed.
    $('#galleryDiv').css({'height':'0px'}); 
    $('#galleryDiv').hide();
    
    // Barely highlight the current selected picture on the mainDiv 
    $('#content > img').hover(function () {
        var $this   = $(this);
        $this.stop().animate({'opacity':'1.0'},100);
    },function () {
        var $this   = $(this);
        $this.stop().animate({'opacity':'0.9'},100);
    });
    
    // Launch the gallery when the user clicks on an image 
    // on the mainDiv/content section ...
    $('#content > img').bind('click', function() {

      var $this = $(this);

      // ...create an image tag (notice that at this point is an orphan element)
      $('<img id="bigphoto" />').load(function(){

        // ...send the mainDiv to the back...
        $('#mainDiv').css({'z-index':'0'});  

        // ...bring the galleryDiv to the front...
        $('#galleryDiv:hidden').show();
        $('#galleryDiv').css({'z-index':'100'});

        currentPicture = $this.index('img');
        var $theImage = $(this);

        resize($theImage);

        // ...link the new/orphan image tag to the galleryContent div.
        $('#galleryContent').append($theImage);
        $theImage.fadeIn(nextPictureSpeed);

        // ...resize the galleryDiv to take over the screen...
        $('#galleryDiv').animate({'height':'100%'},showGallerySpeed,function(){

          // ...collapse the mainDiv
          $('#mainDiv').css({'height':'0px'}); 
          
          // enable the previous button (if needed)
          navigationButtons(currentPicture, totalpictures);
              
          // enable the close button
          $('#closeButton').fadeIn();
          
        }); // animate

      }).attr('src', $this.attr('alt'));
      
      // Wire the next/previous/close buttons
      $('#next').bind('click',function(){
          var $this           = $(this);
          var $nextimage 		= $('#content img:eq(' + (currentPicture+1) + ')');
          navigate($nextimage,'right');
      });
      
      $('#prev').bind('click',function(){
          var $this           = $(this);
          var $previmage 		= $('#content img:eq(' + (currentPicture-1) + ')');
          navigate($previmage,'left');
      });
      
      $('#closeButton').bind('click', function(){
          $('#galleryContent > img').click();	/* simulates click on large photo */
      });
                      
    }); // $('#content > img').bind('click')

    // Bring back the mainDiv when the user clicks on the picture in the gallery
    // (notice that we use live instead of bind because the image is not added
    // until the user clicks on.)
    $('#galleryContent > img').live('click', function() {

      $this = $(this);

      // ...send the gallery to the back...
      $('#galleryDiv').css({'z-index':'0'});
      
      // ...bring the mainDiv to the front...
      $('#mainDiv').css({'z-index':'100'});

      // ...resize the mainDiv to take over the screen...
      $('#mainDiv').animate({'height':'100%'},showGallerySpeed,function(){
         
         // blow away the dynamic element added for the photo
         // TODO: figure out why $('#bigphoto').remove(); does not work here?
         $this.remove();
         
         // hide and un-wire the navigation buttons
         $('#prev').unbind('click');
         $('#next').unbind('click');
         $('#closeButton').unbind('click');
         
         $('#prev').hide();
         $('#next').hide();
         $('#closeButton').hide();
         
         // ...and or course, collapse the galleryDiv
        $('#galleryDiv').css({'height':'0px'}); 
        
      }); // animate

    }); // $('#galleryContent > img').live('click')

    // Given the next or previous image to show,
    // and the direction, it loads a new image in the panel
    // (TODO: There is some code duplication here witht the code
    // above to load the image initially. Can this be optimized?)
    function navigate($nextimage,dir){

        if(dir=='left' && currentPicture==0)
            return;
        if(dir=='right' && currentPicture==parseInt(totalpictures-1))
            return;

        // ...create an image tag (notice that at this point is an orphan element)
        $('<img/>').load(function(){
          
             var $theImage = $(this);
             //$('#loading').hide();
             //$('#description').empty().fadeOut();
              
             $('#galleryContent img').stop().fadeOut(500,function(){
                 
                 // Remove the current image in the gallery
                 var $this = $(this);
                 $this.remove();
                 
                 resize($theImage);
                 
                 // ...link the new/orphan image tag to the galleryContent div.
                 $('#galleryContent').append($theImage.show());
                 $theImage.stop().fadeIn(800);

                 //var title = $nextimage.attr('title');
                 //if(title != ''){
                 //   $('#description').html(title).show();
                 //}
                 //else
                 //     $('#description').empty().hide();

                 navigationButtons(currentPicture, totalpictures);
             });
             
             if(dir=='right')
                 ++currentPicture;
             else if(dir=='left')
                 --currentPicture;

         }).attr('src', $nextimage.attr('alt'));

    } // navigate
    
    function navigationButtons(current, totalpictures) {
      if(current==0)
          $('#prev').hide();
      else
          $('#prev').show();
          
      if(current==parseInt(totalpictures-1))
          $('#next').hide();
      else
          $('#next').show();        
    } // navigationButtons()

    // Resizes the given image to fit nicely in the current window size
    function resize($image){
      var windowH      = $(window).height()-100;
      var windowW      = $(window).width()-80;
      var theImage     = new Image();
      theImage.src     = $image.attr("src");
      var imgwidth     = theImage.width;
      var imgheight    = theImage.height;

      if((imgwidth > windowW)||(imgheight > windowH)){
        if(imgwidth > imgheight){
          var newwidth = windowW;
          var ratio = imgwidth / windowW;
          var newheight = imgheight / ratio;
          theImage.height = newheight;
          theImage.width= newwidth;
          if(newheight>windowH){
            var newnewheight = windowH;
            var newratio = newheight/windowH;
            var newnewwidth =newwidth/newratio;
            theImage.width = newnewwidth;
            theImage.height= newnewheight;
          }
        }
        else{
          var newheight = windowH;
          var ratio = imgheight / windowH;
          var newwidth = imgwidth / ratio;
          theImage.height = newheight;
          theImage.width= newwidth;
          if(newwidth>windowW){
            var newnewwidth = windowW;
            var newratio = newwidth/windowW;
            var newnewheight =newheight/newratio;
            theImage.height = newnewheight;
            theImage.width= newnewwidth;
          }
        }
      }
      $image.css({'width':theImage.width+'px','height':theImage.height+'px'});
    } // resize()

  }); // Picture gallery 

  </script>

</body>
